設定window排程
1.將D:\Project\mqc_web\form內按樹狀結構壓縮所有子目錄及其中檔案
2.將壓縮檔命名為西元月份日期時間_MQC_FORM_IMG.zip ex.202403051200005_MQC_FORM_IMG.zip
3.將西元月份日期時間_MQC_FORM_IMG.zip儲存在D:\Project\mqc_web\Database\HIS
4.刪除D:\Project\mqc_web\form子資料夾內的檔案,要保留資料夾
5.每半小時執行一次

@echo off
setlocal

rem 檢查指定目錄是否有檔案
set "dir=D:\Project\mqc_web\form"
dir /a-d /b "%dir%\*" >nul 2>&1
if errorlevel 1 (
    echo No files found in %dir%.
    exit /b
)

rem 設定壓縮檔名
set "datetime=%date:~0,4%%date:~5,2%%date:~8,2%%time:~0,2%%time:~3,2%%time:~6,2%"
set "zipfile=D:\Project\mqc_web\Database\HIS\%datetime%_MQC_FORM_IMG.zip"

rem 壓縮檔案
"C:\Program Files\WinRAR\WinRAR.exe" a -afzip "%zipfile%" "%dir%"

rem 刪除子目錄內的檔案
for /d %%D in ("%dir%\*") do del /q "%%D\*"

endlocal

執行上述指令後%datetime%_MQC_FORM_IMG.zip解壓縮後的目錄結構如下:
Project-->mqc_web-->form--continue (可能含.csv or .txt檔案)
                        --rowdata (可能含.csv or .txt檔案)
                        --img (可能含.png檔案)
如何改成解壓縮後目錄結構為:
form--continue (可能含.csv or .txt檔案)
    --rowdata (可能含.csv or .txt檔案)
    --img (可能含.png檔案)



---------------------
@echo off
setlocal

rem 取得上一次壓縮檔案的日期和時間
for /f "tokens=1,2 delims=_" %%a in ('dir /b /od "D:\Project\mqc_web\Database\HIS\*_MQC_FORM_IMG.zip"') do (
    set "last_compressed_datetime=%%a_%%b"
)

rem 如果找不到上一次壓縮檔案，設置初始值為空
if not defined last_compressed_datetime set "last_compressed_datetime="

rem 顯示上一次壓縮檔案的日期和時間
echo Last compressed datetime: %last_compressed_datetime%

rem 設定壓縮檔名
set "datetime=%date:~0,4%%date:~5,2%%date:~8,2%%time:~0,2%%time:~3,2%%time:~6,2%"
set "zipfile=D:\Project\mqc_web\Database\HIS\%datetime%_MQC_FORM_IMG.zip"

rem 找出在上一次壓縮檔案之後新增的檔案並壓縮它們
forfiles /p "D:\Project\mqc_web\form" /s /m * /d +%last_compressed_datetime% /c "cmd /c if @isdir==FALSE \"C:\Program Files\WinRAR\WinRAR.exe\" a -afzip -ep1 \"%zipfile%\" @path"

endlocal

1.執行D:\Project\mqc_web\formcod資料夾內的download_mqc_rowdata_nopeak.py
2.執行D:\Project\mqc_web\formcod資料夾內的mqc_nopeak.py
3.將D:\Project\mqc_web\Database內的.zip檔案mput至ftp://tcftp001/ruby/
4.刪除D:\Project\mqc_web\Database內的.zip檔案
@echo off
python D:\Project\mqc_web\formcod\download_mqc_rowdata_nopeak.py
python D:\Project\mqc_web\formcod\mqc_nopeak.py
ftp -s:"D:\Project\mqc_web\Database\ftp_script.txt"
del /Q D:\Project\mqc_web\Database\*.zip


cd /d D:/Project/mqc_web/form/img
"C:\Program Files\WinRAR\WinRAR.exe" -afzip
D:/Project/mqc_web/Database/HIS/MQC_FORM_IMG.zip *.png
